# git-stashx

Gitの作業状態（ステージング状態と未ステージの変更）をバックアップ・復元するCLIツール。

## 概要

`git-stashx`は、`git stash`と異なり、ステージング状態を保持したままバックアップを作成し、後で正確に復元できるツールです。バックアップは専用のブランチとして保存されるため、通常のGit操作で管理できます。

## 特徴

- ステージング状態と未ステージの変更を別々のコミットとして保存
- バックアップはブランチとして管理（`stashx/YYYY-MM-DD-HH-mm-ss`形式）
- 対話的な復元機能
- 新規ファイル（untracked files）も含めてバックアップ
- `.gitignore`されたファイルは自動的に除外

## インストール

```bash
# Denoがインストールされている必要があります
deno install --allow-run --allow-read --allow-write --name git-stashx mod.ts
```

## 使い方

### バックアップの作成

```bash
git-stashx save [description]
```

- 現在の作業状態をバックアップします
- `description`は任意のバックアップ説明（コミットメッセージに含まれます）
- ステージング済みの変更とステージング前の変更は別々のコミットとして保存されます

### バックアップの復元

```bash
git-stashx restore [stash-name]
```

- 指定したバックアップを復元します
- `stash-name`を省略すると、対話的に選択できます
- 現在の作業ディレクトリがクリーンでない場合はエラーになります

### バックアップ一覧の表示

```bash
git-stashx list
```

- 作成済みのバックアップ一覧を表示します
- 各バックアップの作成日時と説明が表示されます

## 動作の詳細

### バックアップ処理

1. 新しいブランチを作成（`stashx/YYYY-MM-DD-HH-mm-ss`）
2. ステージング済みの変更をコミット（"Staged changes"）
3. ステージング前の変更と新規ファイルをコミット（"Unstaged changes"）
4. 元のブランチに戻る

### 復元処理

1. 指定されたバックアップブランチの存在確認
2. 現在のブランチにマージ可能かチェック
3. ステージング済み変更のコミットをcherry-pick
4. ステージング前変更のコミットをcherry-pick
5. ステージング済み変更のコミットをsoft reset（ステージング状態を復元）
6. ステージング前変更のコミットをmixed reset（変更を作業ディレクトリに復元）

## エラーハンドリング

- 作業ディレクトリがクリーンでない場合、復元は実行されません
- マージコンフリクトが発生する可能性がある場合、復元は中止されます
- エラー発生時は詳細なログが出力されます

## 要件

- Deno 1.40以上
- Git 2.0以上

## ライセンス

MIT
